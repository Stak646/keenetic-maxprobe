#!/bin/sh
set -eu
BASE="/opt/etc/init.d"

usage() {
  echo "usage: entwarectl <list|start|stop|restart|status> [service]" >&2
}

cmd="${1:-}"
svc="${2:-}"

case "$cmd" in
  list)
    ls -1 "$BASE" 2>/dev/null || true
    ;;
  start|stop|restart|status)
    [ -n "$svc" ] || { usage; exit 2; }
    script="$BASE/$svc"
    [ -x "$script" ] || { echo "no such init script: $script" >&2; exit 1; }
    "$script" "$cmd" || "$script" "${cmd}" || true
    ;;
  *)
    usage
    exit 2
    ;;
esac
